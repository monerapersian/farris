{% extends "dashboard/base_dashboard.html" %}
{% block content %}

<div class="flex justify-between items-center mb-6">
  <h2 class="text-2xl font-bold">ğŸ¬ Ø¢Ù…ÙˆØ²Ø´â€ŒÙ‡Ø§</h2>
  <a href="{% url 'dashboard_course_add' %}" class="btn btn-primary">â• Ø§ÙØ²ÙˆØ¯Ù† Ø¢Ù…ÙˆØ²Ø´</a>
</div>

<table class="table w-full border">
  <thead>
    <tr>
      <th>#</th>
      <th>Ø¹Ù†ÙˆØ§Ù†</th>
      <th>ÙˆÛŒÚ˜Ù‡</th>
      <th>ØªØ§Ø±ÛŒØ® Ø§ÛŒØ¬Ø§Ø¯</th>
      <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
    </tr>
  </thead>
  <tbody>
    {% for course in page_obj %}
    <tr>
      <td>{{ forloop.counter0|add:page_obj.start_index }}</td>
      <td>{{ course.title }}</td>
      <td>{% if course.special %}âœ…{% else %}âŒ{% endif %}</td>
      <td>{{ course.created_at|date:"Y/m/d H:i" }}</td>
      <td class="flex gap-2">
        <a href="{% url 'dashboard_course_edit' course.id %}" class="btn btn-sm btn-warning">ÙˆÛŒØ±Ø§ÛŒØ´</a>
        <button onclick="openDeleteCourseModal('{{ course.id }}', '{{ course.title }}')" class="btn btn-sm btn-error">Ø­Ø°Ù</button>
      </td>
    </tr>
    {% empty %}
    <tr>
      <td colspan="5" class="text-center text-gray-500">Ù‡ÛŒÚ† Ø¢Ù…ÙˆØ²Ø´ÛŒ Ø«Ø¨Øª Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª.</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<!-- Pagination -->
<div class="mt-4">
  {% include "dashboard/partials/pagination.html" with page_obj=page_obj %}
</div>

<!-- Modal Ø­Ø°Ù Ø¢Ù…ÙˆØ²Ø´ -->
<dialog id="deleteCourseModal" class="modal">
  <div class="modal-box">
    <h3 class="font-bold text-lg text-error">âš ï¸ ØªØ£ÛŒÛŒØ¯ Ø­Ø°Ù</h3>
    <p class="py-4" id="deleteCourseMessage">Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù Ø§ÛŒÙ† Ø¢Ù…ÙˆØ²Ø´ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ</p>

    <div class="modal-action">
      <form method="post" id="deleteCourseForm">
        {% csrf_token %}
        <button type="submit" class="btn btn-error">Ø¨Ù„Ù‡ØŒ Ø­Ø°Ù Ø´ÙˆØ¯</button>
      </form>
      <button type="button" class="btn" onclick="closeDeleteCourseModal()">Ø§Ù†ØµØ±Ø§Ù</button>
    </div>
  </div>
</dialog>

<script>
  function openDeleteCourseModal(id, title) {
    const modal = document.getElementById("deleteCourseModal");
    const form = document.getElementById("deleteCourseForm");
    const msg = document.getElementById("deleteCourseMessage");

    msg.innerHTML = `Ø´Ù…Ø§ Ø¯Ø± Ø­Ø§Ù„ Ø­Ø°Ù Ø¢Ù…ÙˆØ²Ø´ <b class="text-error">Â«${title}Â»</b> Ù‡Ø³ØªÛŒØ¯. Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ`;
    form.action = `/dashboard/courses/delete/${id}/`;
    modal.showModal();
  }

  function closeDeleteCourseModal() {
    document.getElementById("deleteCourseModal").close();
  }
</script>

{% endblock %}